import{jsx as r}from"react/jsx-runtime";import e from"@darkroom.engineering/tempus";import t from"clsx";import n from"lenis";import{useState as s,useEffect as l,createContext as o,forwardRef as i,useRef as c,useCallback as a,useImperativeHandle as u,useContext as f}from"react";"function"==typeof SuppressedError&&SuppressedError;const p=o(null),d=new class Store{constructor(r){this.listeners=[],this.state=r}set(r){this.state=r;for(let r of this.listeners)r(this.state)}subscribe(r){return this.listeners=[...this.listeners,r],()=>{this.listeners=this.listeners.filter((e=>e!==r))}}get(){return this.state}}({});function useCurrentLenis(){const r=f(p),e=function useStore(r){const[e,t]=s(r.get());return l((()=>r.subscribe((r=>t(r)))),[r]),e}(d);return null!=r?r:e}function useLenis(r,e=[],t=0){const{lenis:n,addCallback:s,removeCallback:o}=useCurrentLenis();return l((()=>{if(r&&s&&o&&n)return s(r,t),r(n),()=>{o(r)}}),[n,s,o,t,...e]),n}const m=i(((o,i)=>{var{children:f,root:m=!1,options:b={},autoRaf:h=!0,rafPriority:y=0,className:v}=o,g=function __rest(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]])}return t}(o,["children","root","options","autoRaf","rafPriority","className"]);const O=c(null),k=c(null),[N,j]=s(void 0),C=c([]),w=a(((r,e)=>{C.current.push({callback:r,priority:e}),C.current.sort(((r,e)=>r.priority-e.priority))}),[]),S=a((r=>{C.current=C.current.filter((e=>e.callback!==r))}),[]);u(i,(()=>({wrapper:O.current,content:k.current,lenis:N})),[N]),l((()=>{const r=new n(Object.assign(Object.assign({},b),!m&&{wrapper:O.current,content:k.current}));return j(r),()=>{r.destroy(),j(void 0)}}),[m,JSON.stringify(b)]),l((()=>{if(N&&h)return e.add((r=>{null==N||N.raf(r)}),y)}),[N,h,y]),l((()=>{if(m&&N)return d.set({lenis:N,addCallback:w,removeCallback:S}),()=>d.set({})}),[m,N,w,S]);const P=a((r=>{for(let e=0;e<C.current.length;e++)C.current[e].callback(r)}),[]);l((()=>(null==N||N.on("scroll",P),()=>{null==N||N.off("scroll",P)})),[N,P]);const x=a((()=>{O.current&&(O.current.className=t(null==N?void 0:N.className,v))}),[N,v]);return l((()=>(x(),null==N||N.on("className change",x),()=>{null==N||N.off("className change",x)})),[N,x]),r(p.Provider,{value:{lenis:N,addCallback:w,removeCallback:S},children:m?f:r("div",Object.assign({ref:O,className:t(null==N?void 0:N.className,v)},g,{children:r("div",{ref:k,children:f})}))})}));export{m as Lenis,p as LenisContext,m as ReactLenis,m as default,useLenis};
//# sourceMappingURL=lenis-react.mjs.map
